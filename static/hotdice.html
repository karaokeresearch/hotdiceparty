<!doctype html>

<html lang="en">
<head>
    <script src="jquery-3.5.0.min.js"></script>
    <script src="hotdice.js"></script>
    <meta charset="utf-8">

  <title>Hot Dice UI demo</title>
  
  <link rel="stylesheet" href="styles.css?v=1.0">

</head>

<body>

<div id="console">0 ❌</div>    
    
<script>

var diceAnimate=function(diceNum,outcome,iteration){
    if (iteration==undefined){iteration=0}
    //console.log(iteration);
    if (iteration==7){
        $("#d"+ diceNum).html(diceUnicode[outcome])
    }
    else{
    iteration++;
    $("#d"+ diceNum).html(diceUnicode[rollDice()]);
    
    (function(diceNum, outcome, iteration){
        setTimeout(function(){
        diceAnimate(diceNum, outcome, iteration)
        },30);
    }(diceNum, outcome, iteration));
        
    }
    
}    
        
$( document ).ready(function() {
    var totalDice=6;
    var outcome;
    currentRoll=[];
    currentEval=[false,false,false,false,false,false]; //dice currently being evaluated
    for (var i=0; i<totalDice; i++){
        outcome=rollDice();
        currentRoll.push(outcome);
        $("#diceholder").append('<div id="d' + i+ '"class="dice" style="left:' + (40+ (i*15)) + 'vh">' +  '</div>');
        
        
        (function(i,outcome){
            setTimeout(function(){
                console.log(i,outcome);    
                diceAnimate(i,outcome);
            },i*100);
        }(i,outcome));

    }
    console.log(currentRoll);
    
    $( ".dice" ).on( "click", function() {
        var whichDice=($( this ).attr('id').substring(1));
        console.log("dice " + whichDice + ": " + currentRoll[whichDice]);
        
        if(currentEval[whichDice]==false ){
            currentEval[whichDice]=true;        
            $( this ).animate({top: "80vh"},300);
        }else{
            currentEval[whichDice]=false;        
            $( this ).animate({top: "40vh"},300);
        }
        
        var evalArr=[];
        for (var i=0; i<6; i++){
            if (currentEval[i]==true){
            evalArr.push(currentRoll[i])    
            }
        }
        var evalResults=evalPoints(evalArr);
        //console.log(evalResults);
        var scoring='❌';
        if (evalResults.scoringDice==evalArr.length && evalArr.length>0){
           scoring='✅'; 
        }
        $("#console").html(evalResults.points + " " + scoring );
    });
    
    
    
})
    
    
</script>
<div id="diceholder">
    
</div>
</body>
</html>